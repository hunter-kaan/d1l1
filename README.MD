Алгоритм разборки-сборки.
===================

Код страшный, слабонервным не смотреть.
Могут быть проблемы с матрицей последователей
